# Test Report

**Generated:** 2025-08-12T04:25:50.403Z
**Total Duration:** 26101ms
**Tests Passed:** 3
**Tests Failed:** 1

## Test Results

### ✅ Student Generation
**Status:** PASS
**Duration:** 891ms

**Output:**
```
🚀 Starting student generation...
📚 Generating 10 students for FIRST...
📚 Generating 10 students for SECOND...
📚 Generating 10 students for THIRD...
💾 Inserting students into database...

```

### ✅ Comprehensive Attendance Scenarios
**Status:** PASS
**Duration:** 15977ms

**Output:**
```
🧪 Starting comprehensive attendance scenario testing...
👥 Found 30 students for testing
📅 Testing scenarios for 8/2025 and 7/2025

📊 Student Distribution:
- SECOND_LITERARY: 5 students
- SECOND_SCIENTIFIC: 5 students
- THIRD_SCIENTIFIC: 5 students
- FIRST_NONE: 10 students
- THIRD_LITERARY: 5 students

📊 Scenario 1: Perfect Attendance Students
⚠️  Student cmdmyix1w000iftg8sxeihpet already marked for 2025-07-31
⚠️  Student cmdmyiwpp0005ftg8g6uxsap9 already marked for 2025-07-31
⚠️  Student cmdmyix6k000nftg80mrc9zap already marked for 2025-07-31
✅ Created perfect attendance for 6 students

📊 Scenario 2: Good Attendance Students
⚠️  Student cmdmyix5n000mftg81c5elut7 already marked for 2025-07-31
⚠️  Student cmdmyiww9000cftg81opwyleu already marked for 2025-07-31
⚠️  Student cmdmyixab000rftg83dvd8jy5 already marked for 2025-07-31
⚠️  Student cmdmyix8g000pftg8oxidnw20 already marked for 2025-07-31
⚠️  Student cmdmyix0y000hftg8kakasgtr already marked for 2025-07-31
⚠️  Student cmdmyiwsi0008ftg8pva7irto already marked for 2025-07-31
✅ Created good attendance for 12 students

📊 Scenario 3: Average Attendance Students
✅ Created average attendance for 7 students

📊 Scenario 4: Poor Attendance Students
✅ Created poor attendance for 3 students

📊 Scenario 5: Absent Students
✅ 2 students with no attendance records (testing absence handling)

📊 Scenario 6: Makeup Sessions
✅ Created makeup sessions for 4 students

📊 Scenario 7: Late Enrollment Students
⚠️  Student cmdmyix1w000iftg8sxeihpet already marked for 2025-08-18
⚠️  Student cmdmyix1w000iftg8sxeihpet already marked for 2025-08-25
⚠️  Student cmdmyix1w000iftg8sxeihpet already marked for 2025-08-28
⚠️  Student cmdmyiwvc000bftg8qltml55j already marked for 2025-08-17
⚠️  Student cmdmyiwvc000bftg8qltml55j already marked for 2025-08-20
⚠️  Student cmdmyiwvc000bftg8qltml55j already marked for 2025-08-24
⚠️  Student cmdmyiwvc000bftg8qltml55j already marked for 2025-08-31
⚠️  Student cmdmyix7i000oftg8yy22gpit already marked for 2025-08-17
⚠️  Student cmdmyix7i000oftg8yy22gpit already marked for 2025-08-20
⚠️  Student cmdmyix7i000oftg8yy22gpit already marked for 2025-08-24
⚠️  Student cmdmyix7i000oftg8yy22gpit already marked for 2025-08-27
⚠️  Student cmdmyix7i000oftg8yy22gpit already marked for 2025-08-31
⚠️  Student cmdmyiwpp0005ftg8g6uxsap9 already marked for 2025-08-18
⚠️  Student cmdmyiwpp0005ftg8g6uxsap9 already marked for 2025-08-25
⚠️  Student cmdmyiwpp0005ftg8g6uxsap9 already marked for 2025-08-28
⚠️  Student cmdmyix6k000nftg80mrc9zap already marked for 2025-08-16
⚠️  Student cmdmyix6k000nftg80mrc9zap already marked for 2025-08-19
⚠️  Student cmdmyix6k000nftg80mrc9zap already marked for 2025-08-23
⚠️  Student cmdmyix6k000nftg80mrc9zap already marked for 2025-08-26
⚠️  Student cmdmyix6k000nftg80mrc9zap already marked for 2025-08-28
✅ Updated enrollment dates and created attendance for 5 late enrollment students

📈 Comprehensive Test Results:
- Total attendance records created: 431
- Regular attendance: 415
- Makeup attendance: 16

🔍 Testing Database Constraints:
✅ Duplicate attendance properly prevented by unique constraint
✅ Foreign key constraint working properly

📊 Detailed Statistics:
Attendance by Group Day:
- MON_THU: 135 total (135 regular, 0 makeup)
- SUN_WED: 171 total (167 regular, 4 makeup)
- SAT_TUE_THU: 230 total (224 regular, 6 makeup)
- SAT_TUE: 92 total (84 regular, 8 makeup)

Attendance by Grade/Section:
- SECOND_LITERARY: 105 total (105 regular, 0 makeup)
- SECOND_SCIENTIFIC: 97 total (94 regular, 3 makeup)
- THIRD_SCIENTIFIC: 128 total (128 regular, 0 makeup)
- FIRST_NONE: 174 total (165 regular, 9 makeup)
- THIRD_LITERARY: 124 total (118 regular, 6 makeup)

📊 Attendance Rate Analysis:

8/2025 Attendance Summary:
- Students with attendance: 28
- Total attendance records: 221
- Regular attendance: 212
- Makeup attendance: 9

7/2025 Attendance Summary:
- Students with attendance: 28
- Total attendance records: 202
- Regular attendance: 195
- Makeup attendance: 7

✅ Comprehensive attendance scenario testing completed successfully!

```

### ✅ Comprehensive Payment Scenarios
**Status:** PASS
**Duration:** 9219ms

**Output:**
```
💰 Starting comprehensive payment scenario testing...
👥 Found 30 students for payment testing
📅 Testing payment scenarios for months: 5/2025, 6/2025, 7/2025, 8/2025, 9/2025
🗑️  Cleared existing payment data for test months

⚙️  Setting up payment configurations...
✅ Payment configurations created/updated

📊 Student Enrollment Distribution:
- Long-term students (enrolled 3+ months ago): 22
- Recent students (enrolled within 3 months): 8
- Future enrollment students: 0

📊 Scenario 1: Excellent Payment History
✅ Created excellent payment history for 4 students

📊 Scenario 2: Good Payment History
✅ Created good payment history for 9 students

📊 Scenario 3: Average Payment History
✅ Created average payment history for 5 students

📊 Scenario 4: Poor Payment History
✅ Created poor payment history for 4 students

📊 Scenario 5: Recent Students Payment Patterns
✅ Created payment patterns for 8 recent students

📊 Scenario 6: Payment Corrections and Adjustments
⚠️  Payment record already exists for student cmdmyix1w000iftg8sxeihpet for 8/2025
⚠️  Payment record already exists for student cmdmyiwvc000bftg8qltml55j for 8/2025
⚠️  Payment record already exists for student cmdmyix7i000oftg8yy22gpit for 8/2025
✅ Created payment corrections for 3 students

📊 Scenario 7: Advance Payments
⚠️  Payment record already exists for student cmdmyiwly0001ftg8j3wgg0xo for 9/2025
✅ Created advance payments for 1 students

📈 Comprehensive Payment Test Results:
- Total payment records created: 130
- Paid payments: 97
- Unpaid payments: 33
- Total revenue: ٢٣٬٦٤٠ EGP
- Payment rate: 74.6%

🔍 Testing Database Constraints:
✅ Duplicate payment record properly prevented by unique constraint
✅ Foreign key constraint working properly
✅ Duplicate receipt properly prevented by unique constraint

📊 Detailed Payment Statistics:
Payment Analysis by Grade/Section:
- FIRST_NONE: 42 payments, ٨٬٤٠٠ EGP (avg: 200 EGP)
- THIRD_SCIENTIFIC: 19 payments, ٥٬٧٠٠ EGP (avg: 300 EGP)
- SECOND_SCIENTIFIC: 13 payments, ٣٬٢٥٠ EGP (avg: 250 EGP)
- THIRD_LITERARY: 23 payments, ٦٬٤٤٠ EGP (avg: 280 EGP)
- SECOND_LITERARY: 15 payments, ٣٬٤٥٠ EGP (avg: 230 EGP)

Monthly Payment Distribution:
- أبريل 2025 (Unpaid): 6 records
- أبريل 2025 (Paid): 15 records
- مايو 2025 (Unpaid): 6 records
- مايو 2025 (Paid): 16 records
- يونيو 2025 (Unpaid): 6 records
- يونيو 2025 (Paid): 17 records
- يوليو 2025 (Unpaid): 2 records
- يوليو 2025 (Paid): 23 records
- أغسطس 2025 (Unpaid): 10 records
- أغسطس 2025 (Paid): 20 records
- سبتمبر 2025 (Unpaid): 9 records
- سبتمبر 2025 (Paid): 21 records

💡 Payment Configuration Verification:
Found 5 active payment configurations:
- FIRST NONE: 200 EGP
- SECOND LITERARY: 230 EGP
- SECOND SCIENTIFIC: 250 EGP
- THIRD LITERARY: 280 EGP
- THIRD SCIENTIFIC: 300 EGP

📅 Enrollment-Based Payment Eligibility Test:
8/2025: 30 eligible students, 30 payment records created
9/2025: 30 eligible students, 30 payment records created

✅ Comprehensive payment scenario testing completed successfully!

```

### ❌ Database Integrity Check
**Status:** FAIL
**Duration:** 13ms

**Error:**
```

Invalid `prisma.$queryRaw()` invocation:


Raw query failed. Code: `1`. Message: `no such column: studentCode`
```

