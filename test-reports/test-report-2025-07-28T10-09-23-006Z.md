# Test Report

**Generated:** 2025-07-28T10:09:23.006Z
**Total Duration:** 21287ms
**Tests Passed:** 3
**Tests Failed:** 1

## Test Results

### âœ… Student Generation
**Status:** PASS
**Duration:** 760ms

**Output:**
```
ğŸš€ Starting student generation...
ğŸ“š Generating 10 students for FIRST...
ğŸ“š Generating 10 students for SECOND...
ğŸ“š Generating 10 students for THIRD...
ğŸ’¾ Inserting students into database...

```

### âœ… Comprehensive Attendance Scenarios
**Status:** PASS
**Duration:** 12090ms

**Output:**
```
ğŸ§ª Starting comprehensive attendance scenario testing...
ğŸ‘¥ Found 30 students for testing
ğŸ“… Testing scenarios for 7/2025 and 6/2025

ğŸ“Š Student Distribution:
- FIRST_NONE: 10 students
- SECOND_LITERARY: 5 students
- SECOND_SCIENTIFIC: 5 students
- THIRD_LITERARY: 5 students
- THIRD_SCIENTIFIC: 5 students

ğŸ“Š Scenario 1: Perfect Attendance Students
âš ï¸  Student cmdmy3qwr0009ftu0k6nbzfyl already marked for 2025-07-31
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-31
âš ï¸  Student cmdmy3qxp000aftu0li73w9ek already marked for 2025-07-31
âš ï¸  Student cmdmy3qq60002ftu040vd1erm already marked for 2025-07-31
âš ï¸  Student cmdmy3qq60002ftu040vd1erm already marked for 2025-06-30
âœ… Created perfect attendance for 6 students

ğŸ“Š Scenario 2: Good Attendance Students
âš ï¸  Student cmdmy3qyn000bftu03zug35nl already marked for 2025-07-31
âš ï¸  Student cmdmy3qs20004ftu08pj0zfk4 already marked for 2025-07-31
âš ï¸  Student cmdmy3qs20004ftu08pj0zfk4 already marked for 2025-06-30
âš ï¸  Student cmdmy3r9v000nftu0jbf9yvjd already marked for 2025-07-31
âš ï¸  Student cmdmy3r57000iftu0rb4sisv8 already marked for 2025-07-31
âœ… Created good attendance for 12 students

ğŸ“Š Scenario 3: Average Attendance Students
âš ï¸  Student cmdmy3qvt0008ftu0pgat5jsv already marked for 2025-07-31
âš ï¸  Student cmdmy3qvt0008ftu0pgat5jsv already marked for 2025-06-30
âœ… Created average attendance for 7 students

ğŸ“Š Scenario 4: Poor Attendance Students
âš ï¸  Student cmdmy3qsz0005ftu0792a6llc already marked for 2025-07-31
âœ… Created poor attendance for 3 students

ğŸ“Š Scenario 5: Absent Students
âœ… 2 students with no attendance records (testing absence handling)

ğŸ“Š Scenario 6: Makeup Sessions
âœ… Created makeup sessions for 4 students

ğŸ“Š Scenario 7: Late Enrollment Students
âš ï¸  Student cmdmy3qwr0009ftu0k6nbzfyl already marked for 2025-07-21
âš ï¸  Student cmdmy3qwr0009ftu0k6nbzfyl already marked for 2025-07-24
âš ï¸  Student cmdmy3qwr0009ftu0k6nbzfyl already marked for 2025-07-28
âš ï¸  Student cmdmy3qwr0009ftu0k6nbzfyl already marked for 2025-07-31
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-15
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-17
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-19
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-22
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-24
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-26
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-29
âš ï¸  Student cmdmy3r49000hftu0vkubygdm already marked for 2025-07-31
âš ï¸  Student cmdmy3qxp000aftu0li73w9ek already marked for 2025-07-21
âš ï¸  Student cmdmy3qxp000aftu0li73w9ek already marked for 2025-07-24
âš ï¸  Student cmdmy3qxp000aftu0li73w9ek already marked for 2025-07-28
âš ï¸  Student cmdmy3qxp000aftu0li73w9ek already marked for 2025-07-31
âš ï¸  Student cmdmy3rd1000qftu0smtbogn7 already marked for 2025-07-20
âš ï¸  Student cmdmy3rd1000qftu0smtbogn7 already marked for 2025-07-23
âš ï¸  Student cmdmy3rd1000qftu0smtbogn7 already marked for 2025-07-27
âš ï¸  Student cmdmy3qp80001ftu0ot18f91n already marked for 2025-07-16
âš ï¸  Student cmdmy3qp80001ftu0ot18f91n already marked for 2025-07-23
âš ï¸  Student cmdmy3qp80001ftu0ot18f91n already marked for 2025-07-27
âš ï¸  Student cmdmy3qp80001ftu0ot18f91n already marked for 2025-07-30
âœ… Updated enrollment dates and created attendance for 5 late enrollment students

ğŸ“ˆ Comprehensive Test Results:
- Total attendance records created: 319
- Regular attendance: 307
- Makeup attendance: 12

ğŸ” Testing Database Constraints:
âœ… Duplicate attendance properly prevented by unique constraint
âœ… Foreign key constraint working properly

ğŸ“Š Detailed Statistics:
Attendance by Group Day:
- MON_THU: 90 total (82 regular, 8 makeup)
- SAT_TUE_THU: 100 total (100 regular, 0 makeup)
- SUN_WED: 62 total (62 regular, 0 makeup)
- SAT_TUE: 84 total (80 regular, 4 makeup)

Attendance by Grade/Section:
- FIRST_NONE: 96 total (91 regular, 5 makeup)
- SECOND_LITERARY: 60 total (57 regular, 3 makeup)
- SECOND_SCIENTIFIC: 77 total (77 regular, 0 makeup)
- THIRD_SCIENTIFIC: 67 total (64 regular, 3 makeup)
- THIRD_LITERARY: 36 total (35 regular, 1 makeup)

ğŸ“Š Attendance Rate Analysis:

7/2025 Attendance Summary:
- Students with attendance: 28
- Total attendance records: 196
- Regular attendance: 190
- Makeup attendance: 6

6/2025 Attendance Summary:
- Students with attendance: 18
- Total attendance records: 122
- Regular attendance: 116
- Makeup attendance: 6

âœ… Comprehensive attendance scenario testing completed successfully!

```

### âœ… Comprehensive Payment Scenarios
**Status:** PASS
**Duration:** 8436ms

**Output:**
```
ğŸ’° Starting comprehensive payment scenario testing...
ğŸ‘¥ Found 30 students for payment testing
ğŸ“… Testing payment scenarios for months: 4/2025, 5/2025, 6/2025, 7/2025, 8/2025
ğŸ—‘ï¸  Cleared existing payment data for test months

âš™ï¸  Setting up payment configurations...
âœ… Payment configurations created/updated

ğŸ“Š Student Enrollment Distribution:
- Long-term students (enrolled 3+ months ago): 15
- Recent students (enrolled within 3 months): 15
- Future enrollment students: 0

ğŸ“Š Scenario 1: Excellent Payment History
âœ… Created excellent payment history for 3 students

ğŸ“Š Scenario 2: Good Payment History
âœ… Created good payment history for 6 students

ğŸ“Š Scenario 3: Average Payment History
âœ… Created average payment history for 3 students

ğŸ“Š Scenario 4: Poor Payment History
âœ… Created poor payment history for 3 students

ğŸ“Š Scenario 5: Recent Students Payment Patterns
âœ… Created payment patterns for 15 recent students

ğŸ“Š Scenario 6: Payment Corrections and Adjustments
âš ï¸  Payment record already exists for student cmdmy3qwr0009ftu0k6nbzfyl for 7/2025
âš ï¸  Payment record already exists for student cmdmy3r49000hftu0vkubygdm for 7/2025
âš ï¸  Payment record already exists for student cmdmy3qxp000aftu0li73w9ek for 7/2025
âœ… Created payment corrections for 3 students

ğŸ“Š Scenario 7: Advance Payments
âœ… Created advance payments for 0 students

ğŸ“ˆ Comprehensive Payment Test Results:
- Total payment records created: 114
- Paid payments: 88
- Unpaid payments: 26
- Total revenue: Ù¢Ù¡Ù¬Ù¥Ù¥Ù  EGP
- Payment rate: 77.2%

ğŸ” Testing Database Constraints:
âœ… Duplicate payment record properly prevented by unique constraint
âœ… Foreign key constraint working properly
âœ… Duplicate receipt properly prevented by unique constraint

ğŸ“Š Detailed Payment Statistics:
Payment Analysis by Grade/Section:
- SECOND_SCIENTIFIC: 20 payments, Ù¥Ù¬Ù Ù Ù  EGP (avg: 250 EGP)
- THIRD_SCIENTIFIC: 17 payments, Ù¥Ù¬Ù¡Ù Ù  EGP (avg: 300 EGP)
- FIRST_NONE: 26 payments, Ù¥Ù¬Ù¢Ù Ù  EGP (avg: 200 EGP)
- SECOND_LITERARY: 15 payments, Ù£Ù¬Ù¤Ù¥Ù  EGP (avg: 230 EGP)
- THIRD_LITERARY: 10 payments, Ù¢Ù¬Ù¨Ù Ù  EGP (avg: 280 EGP)

Monthly Payment Distribution:
- Ø£Ø¨Ø±ÙŠÙ„ 2025 (Unpaid): 4 records
- Ø£Ø¨Ø±ÙŠÙ„ 2025 (Paid): 11 records
- Ù…Ø§ÙŠÙˆ 2025 (Unpaid): 3 records
- Ù…Ø§ÙŠÙˆ 2025 (Paid): 16 records
- ÙŠÙˆÙ†ÙŠÙˆ 2025 (Unpaid): 8 records
- ÙŠÙˆÙ†ÙŠÙˆ 2025 (Paid): 12 records
- ÙŠÙˆÙ„ÙŠÙˆ 2025 (Unpaid): 4 records
- ÙŠÙˆÙ„ÙŠÙˆ 2025 (Paid): 26 records
- Ø£ØºØ³Ø·Ø³ 2025 (Unpaid): 7 records
- Ø£ØºØ³Ø·Ø³ 2025 (Paid): 23 records

ğŸ’¡ Payment Configuration Verification:
Found 5 active payment configurations:
- FIRST NONE: 200 EGP
- SECOND LITERARY: 230 EGP
- SECOND SCIENTIFIC: 250 EGP
- THIRD LITERARY: 280 EGP
- THIRD SCIENTIFIC: 300 EGP

ğŸ“… Enrollment-Based Payment Eligibility Test:
7/2025: 30 eligible students, 30 payment records created
8/2025: 30 eligible students, 30 payment records created

âœ… Comprehensive payment scenario testing completed successfully!

```

### âŒ Database Integrity Check
**Status:** FAIL
**Duration:** 0ms

**Error:**
```
Cannot read properties of undefined (reading 'count')
```

